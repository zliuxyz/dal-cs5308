1.

2.

3. See code.